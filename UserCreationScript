# Import CSV
$Users = Import-Csv -Path "C:/Scripts/Users.csv"

foreach ($User in $Users) {
    # Check if user already exists
    if (Get-ADUser -Filter {DisplayName -eq $User.DisplayName} -ErrorAction SilentlyContinue) {
        Write-Warning "User $($User.DisplayName) already exists. Skipping."
        continue
    }

    # Create the user
    try {
        New-ADUser -Name "$($User.FirstName) $($User.LastName)" `
                   -AccountPassword $SavCone255! `
                   -DisplayName "$($User.firstname) . $($User.lastname)"
                   -Enabled $true `
                   -Path $User.OUPath `

        Write-Output "User $($User.SamAccountName) created successfully."
    }
    catch {
        Write-Error "Failed to create $($User.SamAccountName): $($_.Exception.Message)"
    }
}

Write-Output "Bulk user creation completed."
